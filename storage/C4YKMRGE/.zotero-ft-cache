
Меню

    Главная
    Новости
    Категории
        Инструкции
        Дистрибутивы
        Обзоры
        Программы
        Система
        Оформление
        Терминал
        Информация
        Безопасность
        Сервер
        Ядро
        Программирование
        Игры
        Мультимедиа
        Android
        Windows
        Оборудование
    Рекомендуем
        Дистрибутив
        gVim
        Openshot
        VLC
    Книги
    Опросы
    Losst
        О Проекте
        История Losst
        Обратная связь
        Содержание сайта
        Наши авторы
        Пишите для нас
        Использование материалов

    Главная
    Новости
    Категории
        Инструкции
        Дистрибутивы
        Обзоры
        Программы
        Система
        Оформление
        Терминал
        Информация
        Безопасность
        Сервер
        Ядро
        Программирование
        Игры
        Мультимедиа
        Android
        Windows
        Оборудование
    Рекомендуем
        Дистрибутив
        gVim
        Openshot
        VLC
    Книги
    Опросы
    Losst
        О Проекте
        История Losst
        Обратная связь
        Содержание сайта
        Наши авторы
        Пишите для нас
        Использование материалов

Losst
Главная
Инструкции
Файл подкачки Linux
Файл подкачки Linux
Инструкции 6 ноября, 2019 7 bazilius

Сегодня мы будем говорить о файле подкачки в Linux. Расскажем для чего он нужен, как создать, изменить размер или удалить. В общем, все, что вам может понадобиться при работе со swap .

В операционной системе Linux, как и в других ОС, файл подкачки нужен для страховки оперативной памяти. Когда установленный объем ОЗУ заканчивается, используется именно выделенная область из файла подкачки. Это может понадобиться в двух случаях:

    Для того чтобы при полной занятости и, как следствие, отсутствия свободной оперативной памяти, компьютер не тормозил.
    Для распределения приоритетов (важным процессам отдается физическая оперативная память, а второстепенным файл подкачки Linux).

Сам по себе swap - это отдельный логический раздел вашего диска либо просто файл на системном разделе. Чаще всего он создается именно при установке операционной системы. Но создать swap linux можно и после завершения инсталляции ОС.

В последних версиях операционной системы Ubuntu  Linux  файл подкачки создается автоматически вне зависимости от того, хотите вы этого или нет. При этом его размер составляет около 1 Гб.

Содержание статьи:

    Как посмотреть swap в Linux
    Создание файла подкачки Linux
        Шаг 1: Создаем swap файл
        Шаг 2: Создание файловой системы
        Шаг 3: Активируем файл подкачки
        Шаг 4. Сохранение изменений после перезагрузки
    Настройка swappiness
    Размер swap файла в Linux
    Как удалить файл подкачки в Linux
    В заключение

Как посмотреть swap в Linux

Прежде чем приступить к процессу добавления, настройки или удаление файла подкачки , необходимо проверить его наличие. Для этого проще всего использовать приведенную ниже команду. В нашем случае она выглядит так:

free -h

Используемая команда отображает размер файла подкачки вашей операционной системы. Однако, по ее результатам мы не можем определить – это файл подкачки или раздел подкачки. Поэтому будем использовать дополнительный другую команду, чтобы посмотреть swap linux. Вводим в терминал следующее:

swapon -- show

Как видите, в нашем случае под swap выделено 1.4 Гб и это файл. То есть, он находится не на отдельном разделе, а на том же диске, на котором установлена операционная система.

Если это будет отдельный логический том, то под надписью « TYPE » мы увидим слово «partition».

Если бы файл подкачки в вашей операционной системе отсутствовал, результат работы команды free - h   выглядел бы примерно так:

То есть, вместо каких-либо данных о файле подкачки вы увидите нули.
Создание файла подкачки Linux

Если вы удостоверились в том, что файл подкачки отсутствует, можно переходить к его созданию. Пример, приведенный ниже, будет показан с использованием операционной системы Ubuntu 18.04, но работать это должно и на других дистрибутивах Linux.
Шаг 1: Создаем swap файл

Давайте создадим файл подкачки для нашей Ubuntu. Для примера его размер составит 1 Гб. Запустите терминал и введите команду, приведенную ниже:

sudo fallocate -l 1G /swapfile

Для обеспечения безопасности файла обязательно устанавливаем на него нужные права.

sudo chmod 600 /swapfile

При этом вместо «swapfile» мы можем указать любое другое название.

Шаг 2: Создание файловой системы

Создание swap linux ещё не завершено. Теперь необходимо указать нашей операционной системе, что созданный объект должен использоваться как файл подкачки. Для этого мы будем использовать команду, приведенную ниже:

sudo mkswap /swapfile

Если все сделано верно, результат будет выглядеть так:

Шаг 3: Активируем файл подкачки

Хорошо, теперь наш Linux понимает, что это файл подкачки, но этого недостаточно. Нам также необходимо включить SWAP :

sudo swapon /swapfile

Давайте проверим, все ли мы сделали правильно:

swapon --show

Отлично, операционная система распознала наш файл подкачки и начала его использовать. Мы видим тип в поле TYPE и размер в поле SIZE .
Шаг 4. Сохранение изменений после перезагрузки

Все операции, которые мы предприняли выше, временны. Как только компьютер будет перезагружен, они отменятся. Для того чтобы сделать изменения постоянными, нам необходимо дописать кое-какую информацию в /etc/fstab . Для этого поступаем так:

Прежде чем начать работать с файлом, о котором мы говорим, необходимо обязательно создать его резервную копию:

sudo cp /etc/fstab /etc/fstab.back

После этого можно переходить непосредственно к добавлению нужных нам данных. Нам надо добавить в файл такую строчку:

/swapfile none swap sw 0 0

Это реализуется через текстовый редактор, запущенный с правами суперпользователя, либо при помощи введенной в терминал команды:

echo '/swapfile none swap sw 0 0' | sudo tee -a /etc/fstab

 

Готово. Изменения сохранены и файл подкачки не сбросится после перезагрузки операционной системы.
Настройка swappiness

Дальше будет рассмотрена настройка swap linux. У файла подкачки существуют параметры, которые сообщают ОС, как часто его нужно использовать. Это явление называется «свопингом» и может иметь значение в пределах 0 - 100. Если это значение ближе к 100, ядро будет перемещать в раздел подкачки больше информации чтобы освободить память. При значениях ближе к нулю, система будет использовать подкачку только при крайней необходимости.

К примеру, в версии Ubuntu L inux для рабочего стола устанавливается параметр 60, а в серверных редакциях операционной системы - 1. Для того чтобы проверить, какой параметр используется в нашей ОС, вводим в терминал такую команду:

cat /proc/sys/vm/swappiness

Как видите, в нашем случае «свопинг» установлен как 60. Если же вы хотите поменять swappiness, можете воспользоваться оператором, цифра в конце которого и будет новым значением:

sudo sysctl vm.swappiness=25

Как и в случае с конфигурацией файла подкачки, данный параметр изначально будет временным и обнулится при следующей перезагрузке. Для того чтобы сделать его постоянным, в самом конце файла /etc/sysctl.conf записываем значение vm.swappiness=25 .

vi /etc/sysctl.conf

vm.swappiness=25

Для этого можно воспользоваться, например, текстовым редактором, запущенным с администраторскими полномочиями.
Размер swap файла в Linux

Существует сразу несколько вариантов, позволяющих увеличить файл подкачки linux или уменьшить его. Однако, прежде чем их рассмотреть, необходимо напомнить об одном очень важном моменте:

Когда вы полностью отключаете файл подкачки, ваша операционная система использует только ОЗУ и в случае ее нехватки это может привести к полной остановке работы компьютера. Система просто зависнет.

Для того чтобы этого не произошло, в тот момент, когда мы удаляем или изменяем основной файл подкачки, необходимо создать второй, временный swap. Если вы это сделали или уверены в том, что имеющейся оперативной памяти хватит, можно переходить непосредственно к процессу изменения размера файла подкачки. Для этого давайте сначала отключим его:

sudo swapoff /swapfile

Вторым этапом меняем размер файла подкачки, воспользовавшись командой, приведенной ниже. При этом размер вашего swap файла нужно указать вместо параметра 2G (2 гигабайта):

sudo fallocate -l 2G /swapfile

Теперь форматируем полученный файл в файловую систему swap:

sudo mkswap /swapfile

А затем включаем его обратно:

sudo swapon /swapfile

При этом операционная система Linux позволяет использовать сразу несколько swap .
Как удалить файл подкачки в Linux

Если по каким-то причинам файл подкачки вам не нужен, можете удалить его. Для этого сначала надо отключить swap linux:

sudo swapoff /swapfile

А потом удаляем:

sudo rm /swapfile

Не забудьте установить права на вновь созданный файл подкачки так, как мы описывали это выше.
В заключение

Надеемся теперь концепция файла подкачки в Linux ясна вам на 100%. Можете переходить к практике и проверять наличие swap на вашем компьютере или ноутбуке, его настройке, созданию или даже удалению. Если в результате у вас останутся какие-то вопросы, предложения или замечания, можете задать их нам, воспользовавшись формой комментирования ниже.
Похожие записи:

Нет похожих записей
Creative Commons License
Статья распространяется под лицензией Creative Commons ShareAlike 4.0 при копировании материала ссылка на источник обязательна.
Оцените статью:
Звёзд: 1 Звёзд: 2 Звёзд: 3 Звёзд: 4 Звёзд: 5 ( 10 оценок, среднее: 4,10 из 5)
Загрузка...
Сохранить
Об авторе
bazilius
Ваше имя тоже может быть здесь. Начните писать статьи для Losst. Это просто! Смотрите подробнее как начать писать статьи - Пишите для нас
7 комментариев

    perikop 6 ноября, 2019 Ответить

    }} В последних версиях операционной системы Ubuntu Linux файл подкачки создается автоматически вне зависимости от того, хотите вы этого или нет. При этом его размер составляет около 1 Гб.

    Конечно же это не так!
    Gregori69 6 ноября, 2019 Ответить

    Есть приедложение: вставляй скриншоты именно тех окон, которые необходимы по ходу статьи а не ввесь скриншот твоего рабочего стола, для лучшей читабельности скриншота.
    Энтони 6 ноября, 2019 Ответить

    Вообще, автор несколько недоговаривает насчет свапа в GNU/Linux (вероятно, ввиду незнания). Дело в том, что свап нужен не столько для срочного получения памяти, сколько для ровного и эффективного высвобождения памяти. Использовать его в качестве "срочной памяти" в общем случае очень вредно.

    И отключение swap не спасает от проблемы дискового ввода/вывода при конкуренции за память — дисковый I/O просто перемещается с анонимных страниц на файловые. Это не только может быть менее эффективным, поскольку остаётся меньший пул страниц, доступных для высвобождения, но и само по себе может способствовать появлению этой высокой конкуренции.
        Григорий 8 ноября, 2019 Ответить

        И включение свопа тоже не спасает от заполнения озу дисковым кэшем. На разных дистрибутивах периодически сталкиваюсь с одной и той же проблемой. ОЗУ забивается дисковым кэшем и система начинает тормозить, при том что своп есть, активен, но он не используется. Опытным путем пришел к выводу что система начинает юзать своп отталкиваясь не от параметра в графе "свободно", а от параметра в графе "доступно". Я не знаю верный ли вывод сделал, но со стороны все выглядит именно так. Имею на борту 8 гб ОЗУ. Во время работы системы постепенно дисковый кэш начинает увеличиваться в размере и занимает около 6гб, при этом под реальные нужды используется всего 1,5гб, в графе "свободно" указано около 500мб, в графе доступно около 6,5гб. Стоит только запустить какую-нибудь задачу, которая потребляет озу хотя бы 1,5 -3 гб (игра), как система идёт в штопор, количество свободной памяти уменьшается до минимума прописанного в ядре - 65мб, потом начинает высвобождаться дисковый кэш, но он его просто дропает, а не пишет в своп. Причем дропает примерно до размера чтобы в графе "свободно" было 150-180мб. И после этого система начинает балансировать на этих 180 мб. Всё, естественно, становится дерганным и лагучим. Своп по прежнему не используется. Опытным путем выяснено что своп начинает использоваться тогда, когда в графе "доступно" появляется значение сопоставимое с выставленным параметром swappiness. Мне интересно, так задумано или это баг?
        Приходилось устанавливать минимальное количество свободной озу на 500мб вместо 65. Подбирать swappiness в соответствии с нуждами. Но сам по себе своппинг, тоже по сути зло. В момент доступа к диску все равно наблюдались микрофризы, хотя своп находится на ссд. Решением стала настройка и уменьшение дискового кэша. Конечно, это имеет и свою отрицательную сторону, но тут, как говорится, из двух зол выбирай меньшее.
            Григорий 8 ноября, 2019 Ответить

            Ещё забыл добавить, что если просто во время лагов вручную дропнуть кэш, то система оживает и работает хорошо до тех пор пока озу снова не забьётся кэшем.
    Александр 7 ноября, 2019 Ответить

    спасибо.
    Swap 27 ноября, 2019 Ответить

    После установки Peppermint OS, проверил swap: 2Gb на 8Gb оперативной памяти. Если не делать swap разделом, автоматом будет файл. Мониторил активность, там мегабайт ~100 максимум плавало. Вопрос знающим: чем грозит отключение swap'а?

Ответить
Отменить ответ

Поиск:

    Лучшие
    Последние
    Метки

Лучшие

    Установка Linux рядом с Windows 10
    Янв 19, 2016
    Как сделать загрузочную флешку Ubuntu
    Янв 4, 2016
    Лучший Linux для ноутбука 2019
    8 мая, 2016
    Mi Band 2 не подключается к телефону
    27 мая, 2017
    Настройка Ubuntu 16.04 после установки
    Мар 17, 2016

Последние

    Как заблокировать ip в iptables
    Янв 20, 2020
    Команда tree linux
    Янв 17, 2020
    Как закрыть порт iptables
    Янв 15, 2020
    Установка Docker в CentOS 8
    Янв 13, 2020
    Обзор работы Linux на Ryzen
    Янв 10, 2020

Метки
ubuntu установка сеть ошибки безопасность программирование debian linux mint bash диск kde файловая система оборудование мультимедиа офис команды centos fedora gentoo сервер grub виртуализация обновление редактор windows gnome opensuse unity производительность wine мессенджер настройка пакеты android deb raspberry драйвер mysql ошибка nginx криптовалюта manjaro archlinux microsoft альтернативы восстановление шифрование игры комплектующие оптимизация kubuntu бэкап сравнение php virtualbox ext4 portable snap systemd xfce микрокомпьютер ускорение графика cinnamon видеокарта люди облако очистка флешка терминал плагины браузеры wordpress браузер память носители vpn базы данных причины панели оболочки драйвера пользователи оформление дистрибутивы python apache nvidia reactos группы Xubuntu xorg Java ElementaryOS вирус kali linux сервисы аналоги проекты ядро BSD програмирование iptables wifi dos postgresql libreoffice gimp zabbix vlc bitcoin майнинг уязвимости использование Видео Linux mint WoT прокси squid red hat pacman архивы skype сжатие chrome Steam ssl ssh миникомпьютер контейнеры Программы i3wm DE desktop тайлинг оконный менеджер Android 8.0 файловые системы приложения сравнения вирусы IDE виртуалзиация удаление удаленный доступ arduino usb эмулятор phpmyadmin время freebsd plank dock Монтаж Qt Creator C++ Atom строка опции параметры скрипт командная строка проверка переменные файловый дескриптор Архив tar bzip2 gzip pamac yaourt диски питание dual boot clear reset команда windows manager tiling Andoid Lineageos lineage os cyanogen mod хостинг интерьвю
Реклама
Otus
Опрос

Какая тема лучше для Ubuntu

    Numix (27%, 39 Голосов)
    Arc (17%, 24 Голосов)
    Adwaita (14%, 20 Голосов)
    StylishDark (7%, 10 Голосов)
    Adapta (7%, 10 Голосов)
    Matcha (4%, 6 Голосов)
    Flat Remix (4%, 6 Голосов)
    Paper (3%, 5 Голосов)
    Materia (3%, 5 Голосов)
    Vimix (3%, 4 Голосов)
    DeLorean Dark (3%, 4 Голосов)
    Dorian (2%, 3 Голосов)
    Luv (1%, 2 Голосов)
    Flatabulous (1%, 2 Голосов)
    Vertex (1%, 2 Голосов)
    Arrongin (1%, 2 Голосов)
    Super Flat Remix (1%, 1 Голосов)
    Vivacious (0%, 0 Голосов)
    Ambiance Dark Blue (0%, 0 Голосов)
    Autumn Kerala (0%, 0 Голосов)
    Sable Theme (0%, 0 Голосов)
    Pop (0%, 0 Голосов)

Всего проголосовавших: 145
Загрузка ...  Загрузка ...
Реклама
Подписка на рассылку

Подписывайтесь на обновления и получайте уведомления о новых интересных статьях по почте.
I consent to my submitted data being collected via this form*

Спасибо!

Произошла ошибка, попробуйте еще раз.

Никакой рекламы или спама!
Мы вконтакте

Обнаружили опечатку?
Сообщите нам об этом, выделите текст с ошибкой и нажмите Ctrl+Enter , будем очень признательны!
Мета

    Регистрация
    Войти
    Entries RSS
    Comments RSS

Оставайтесь с нами в социальных сетях:
Мы в Twitter

Tweets by Losst_official
Как заблокировать ip в iptables
20 января, 2020
Команда tree linux
17 января, 2020
Как закрыть порт iptables
15 января, 2020
Установка Docker в CentOS 8
13 января, 2020
Обзор работы Linux на Ryzen
10 января, 2020
Настройка Samba в CentOS 8
8 января, 2020
Обзор Deepin Linux
5 января, 2020
Команда watch Linux
3 января, 2020
Установка 1С на CentOS 8
30 декабря, 2019
Изменение темы GTK для приложения
27 декабря, 2019
Лучшие клиенты Google Drive Linux
25 декабря, 2019
Установка и настройка Openwrt
24 декабря, 2019
Losst Copyright © 2020.
Все права защищены.
Рейтинг@Mail.ru
Сообщить об опечатке
Текст, который будет отправлен нашим редакторам:
Ваш комментарий (необязательно):
Отправить Отмена
03AOLTBLRVDl1Ok_O8e6622KOxi__7O30OQTC7l_PSyyjSTJCvdBOoTVKXyjfeEyZEQ3QK1iJozu4bALob1i4ywsqkYH4R66L18ZA96FPDcjwk7OG2L9PrzgrRrPQ5G4dLf-tvoPtyGrSalkvh6Ag6q9Q_Q_u8Mu3M-muM9lZlmPituFTII9SwwNAduILCP2cB6LR5_1u8EO-dot9r_GSS8QDzYC4nv5Hm0a-QCn3z91pRaoY9NEgRK2aUW1oeClTejrVXpPlyBbhScec7YPz0EhPj266yCqpNK1PoPZc6gUvewZSibKrb-nC0uHub3uB9Anaes0G_iACeZZSJPuJ62AWyGfWtnEPXX30UljaAtx8ZhfUPoEn0gZJwmY-5cuVlK4JdufvrtzA-19tPkUJDkUgOdN1a0_ID2LFGq58qNKX8Io95L1Td6A8
